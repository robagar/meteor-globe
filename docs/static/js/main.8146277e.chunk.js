(this["webpackJsonpmeteor-globe"]=this["webpackJsonpmeteor-globe"]||[]).push([[0],{103:function(e,t){},105:function(e,t){},114:function(e,t,r){"use strict";r.r(t);var n=r(7),a=r.n(n),i=r(63),c=r.n(i),o=(r(74),r(14)),s=r(8),u=r(15),l=r(117),j=r(119),b=6371.37;function h(e){return Math.PI*e/180}function f(e,t,r){var n=h(e),a=h(t),i=r+b;return[i*Math.cos(n)*Math.cos(-a),i*Math.sin(n),i*Math.cos(n)*Math.sin(-a)]}function d(e){var t=e.latitude,r=e.longitude,n=e.height,a=h(t),i=h(r),c=b+n;return[c*Math.cos(a)*Math.cos(-i),c*Math.sin(a),c*Math.cos(a)*Math.sin(-i)]}var m=r(116),p=r(118),x=r(69),O=r(19);Object(O.c)();var v=new x.a({highlightedMarker:"",markers:new Map([["UK003C",{identifier:"UK003C",latitude:50.224871,longitude:-4.949858,label:"UK003C"}]]),meteors:[]}),g=r(10);function k(e){var t=e.identifier,r=e.latitude,n=e.longitude,a=e.altitude,i=void 0===a?5:a,c=e.radius,o=void 0===c?5:c,s=e.label,u=e.labelSize,l=void 0===u?50:u,j=v.useState((function(e){return e.highlightedMarker}))===t,b=function(e){e?v.update((function(e){e.highlightedMarker=t})):v.update((function(e){e.highlightedMarker===t&&(e.highlightedMarker="")}))};return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("mesh",{onPointerOver:function(e){return b(!0)},onPointerOut:function(e){return b(!1)},position:f(r,n,i),children:[Object(g.jsx)("sphereGeometry",{args:[4*o,8,8]}),Object(g.jsx)("meshBasicMaterial",{visible:!1})]}),Object(g.jsxs)("mesh",{position:f(r,n,i),children:[Object(g.jsx)("sphereGeometry",{args:[o,16,16]}),Object(g.jsx)("meshBasicMaterial",{color:"hotpink"})]}),s&&Object(g.jsx)(m.a,{visible:j,position:f(r,n,i+10),children:Object(g.jsx)(p.a,{anchorX:"left",anchorY:"top",fontSize:l,color:"white",children:s})})]})}var M=r(11),w=r(4);function y(e){var t=e.begin,r=e.end,a=d(t),i=d(r),c=Object(M.a)(a,3),o=c[0],s=c[1],l=c[2],j=Object(M.a)(i,3),b=[(o+j[0])/2,(s+j[1])/2,(l+j[2])/2],h=b[0],f=b[1],m=b[2],p=new w.Vector3(h,f,m),x=new w.Vector3(i[0]-a[0],i[1]-a[1],i[2]-a[2]),O=x.length(),v=x.clone();v.normalize();var k=Object(n.useRef)();return Object(u.b)((function(e){var t=e.camera,r=p.clone();r.sub(t.position).normalize();var n=v.clone();n.cross(r).normalize();var a=v.clone();a.cross(n).normalize();var i=v.clone().cross(a),c=k.current;if(c){var o=new w.Matrix4,s=i,u=v,l=a;o.makeBasis(s,u,l),c.quaternion.setFromRotationMatrix(o)}})),Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("mesh",{ref:k,position:b,children:[Object(g.jsx)("planeGeometry",{args:[3,O]}),Object(g.jsx)("meshBasicMaterial",{color:"white"})]})})}function _(){var e=Object(n.useRef)(),t=new w.Vector3(0,1,0),r=new w.Vector3(0,0,0);return Object(u.b)((function(n){var a=n.camera,i=r.clone();i.sub(a.position).normalize();var c=t.clone();c.cross(i).normalize();var o=t.clone();o.cross(c).normalize();var s=t.clone().cross(o),u=e.current;if(u){var l=new w.Matrix4,j=s,b=t,h=o;l.makeBasis(j,b,h),u.quaternion.setFromRotationMatrix(l)}})),Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("mesh",{ref:e,children:[Object(g.jsx)("axesHelper",{args:[3e3]}),Object(g.jsx)("planeGeometry",{args:[2e3,5e3]}),Object(g.jsx)("meshBasicMaterial",{color:"blue"})]})})}function z(e){var t=e.markers,r=e.meteors,n={fov:75,near:10,far:1e5,position:f(50.22,-4.95,3e3)},a=Object(l.a)({map:"/meteor-globe/textures/2_no_clouds_4k.jpeg",bumpMap:"/meteor-globe/textures/elev_bump_4k.jpeg",specularMap:"/meteor-globe/textures/water_4k.png"});return Object(g.jsxs)(u.a,{frameloop:"demand",camera:n,children:[Object(g.jsx)(j.a,{minDistance:6471.37,zoomSpeed:1,rotateSpeed:1}),Object(g.jsx)("ambientLight",{intensity:.1}),Object(g.jsx)("directionalLight",{color:"white",position:f(0,0,1)}),Object(g.jsx)(_,{}),Object(g.jsxs)("mesh",{children:[Object(g.jsx)("sphereGeometry",{args:[b,128,128]}),Object(g.jsx)("meshPhongMaterial",Object(s.a)({},a))]}),t.map((function(e){return Object(g.jsx)(k,Object(s.a)({},e),"marker-".concat(e.identifier))})),r.map((function(e,t){return Object(g.jsx)(y,Object(s.a)({},e),"meteor-".concat(t))}))]})}r(80);var S=r(13),B=r.n(S),F=r(16),P=r(18),G=r(66),R=r.n(G);function V(){return(V=Object(P.a)(B.a.mark((function e(t){var r,n,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(!(r=e.sent).ok){e.next=11;break}return e.next=6,r.text();case 6:return n=e.sent,a=R()(n,{columns:!0}),e.abrupt("return",a.map((function(e){return{identifier:e.camera_id,latitude:e.obs_latitude,longitude:e.obs_longitude}})));case 11:return e.abrupt("return",Promise.reject(r.statusText));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){(function(e){return V.apply(this,arguments)})("/meteor-globe/data/cameradetails.csv").then((function(e){console.info("[cameras]",e),v.update((function(t){var r,n=t.markers,a=Object(F.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;n.set(i.identifier,Object(s.a)(Object(s.a)({},i),{},{label:i.identifier}))}}catch(c){a.e(c)}finally{a.f()}}))})).catch((function(e){console.error("[cameras] load failed",e)}))}var E=r(67),K=r(68);function L(){(function(e){var t,r,n,a,i,c,o;return B.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:t=[],r=!1,n=!1,s.prev=3,i=function(){var e=o.value;if(0===e.length)return"continue";if("\r"===e[0]&&(e=e.slice(1)),"#"===e[0])return"continue";var r=e.split(";");if(83!==r.length)return"continue";var n=function(e){var t=r[e];return t?t.trim():""},a=function(e){return parseFloat(n(e))},i=n(1),c=n(3),s={latitude:a(60),longitude:a(62),height:a(64)},u={latitude:a(66),longitude:a(68),height:a(70)},l=a(76),j=n(82);console.info(i,c,s,u,l,j),t.push({begin:s,end:u})},c=Object(E.a)(Object(K.a)(e));case 6:return s.next=8,B.a.awrap(c.next());case 8:if(!(r=!(o=s.sent).done)){s.next=15;break}if("continue"!==i()){s.next=12;break}return s.abrupt("continue",12);case 12:r=!1,s.next=6;break;case 15:s.next=21;break;case 17:s.prev=17,s.t0=s.catch(3),n=!0,a=s.t0;case 21:if(s.prev=21,s.prev=22,!r||null==c.return){s.next=26;break}return s.next=26,B.a.awrap(c.return());case 26:if(s.prev=26,!n){s.next=29;break}throw a;case 29:return s.finish(26);case 30:return s.finish(21);case 31:v.update((function(e){e.meteors=t}));case 32:case"end":return s.stop()}}),null,null,[[3,17,21,31],[22,,26,30]],Promise)})("https://globalmeteornetwork.org/data/traj_summary_data/daily/traj_summary_yesterday.txt").catch((function(e){console.error("[meteors] load failed",e)}))}var U=function(){var e=v.useState((function(e){return e.markers})),t=v.useState((function(e){return e.meteors}));return Object(n.useEffect)(C,[]),Object(n.useEffect)(L,[]),Object(g.jsx)("div",{className:"App",children:Object(g.jsx)(z,{markers:Object(o.a)(e.values()),meteors:t})})};c.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(a.a.Suspense,{fallback:Object(g.jsx)("div",{children:"Loading... "}),children:Object(g.jsx)(U,{})})}),document.getElementById("root"))},74:function(e,t,r){},80:function(e,t,r){}},[[114,1,2]]]);
//# sourceMappingURL=main.8146277e.chunk.js.map